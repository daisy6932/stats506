---
title: "hw1"
format: html
editor: visual
---

# Problem 1 - Abalone Data

## a. Import the data into a data.frame in R. Use the information in the “abalone.names” file to give appropriate column names.


```{r}
data_file <- "abalone.data"

col_names <- c("Sex", "Length", "Diameter", "Height", "Whole_weight", "Shucked_weight", "Viscera_weight", "Shell_weight", "Rings")

abalone <- read.csv(data_file, header = FALSE, col.names = col_names)

saveRDS(abalone, file = "abalone.rds")
abalone2 <- readRDS("abalone.rds")
```

## b. Report the number of observations belonging to each sex:

```{r}
table(abalone2$Sex)
```

## c.

1.Which weight has the highest correlation with rings?

```{r}
# Calculate correlations
weights <- c("Whole_weight", "Shucked_weight", "Viscera_weight", "Shell_weight")
correlations <- sapply(weights, function(w) cor(abalone2[[w]], abalone2$Rings))

# Show all correlations
correlations

# Find which weight has the maximum absolute correlation
most_correlated_weight <- names(which.max(abs(correlations)))
most_correlated_value <- correlations[most_correlated_weight]

cat(sprintf("The weight variable with the highest correlation with Rings is '%s' (correlation = %.3f).\n", most_correlated_weight, most_correlated_value))
```
2.For that weight, which sex has the highest correlation?

```{r}
#get unique sex categories from the data
sexes <- unique(abalone2$Sex) 

#For each sex, calculate the correlation between the most correlated weight and Rings
cor_by_sex <- sapply(sexes, function(sex){
  idx <- abalone2$Sex == sex   
  cor(abalone2[[most_correlated_weight]][idx], abalone2$Rings[idx], use = "complete.obs")
})

#Name the correlation results according to sex
names(cor_by_sex) <- sexes

print(cor_by_sex)

#Find the sex category with the highest absolute correlation
most_corr_sex <- names(which.max(abs(cor_by_sex)))
most_corr_value <- cor_by_sex[most_corr_sex]

#Print a summary snetence with the results
cat(sprintf(
  "For '%s', the sex with the highest correlation with Rings is '%s' (correlation = %.3f).\n",
  most_correlated_weight, most_corr_sex, most_corr_value
))
```
